{%- comment -%}
  Header section
{%- endcomment -%}

{%- liquid
  assign header_color_scheme = section.settings.color_scheme
  assign header_color_scheme_transparent = section.settings.color_scheme_transparent
  assign enable_transparent_header_home = section.settings.enable_transparent_header_home
  assign enable_transparent_header_product = section.settings.enable_transparent_header_product
  assign enable_transparent_header_collection = section.settings.enable_transparent_header_collection
  assign home_color_scheme = section.settings.home_color_scheme
  assign product_color_scheme = section.settings.product_color_scheme
  assign collection_color_scheme = section.settings.collection_color_scheme
  assign enable_sticky_header = section.settings.enable_sticky_header
  assign divider_width = section.settings.divider_width
  assign divider_size = section.settings.divider_size
  assign logo_position = section.settings.logo_position
  assign menu_position = section.settings.menu_position
  assign menu_row = section.settings.menu_row
  assign show_search = section.settings.show_search
  assign search_position = section.settings.search_position
  assign search_row = section.settings.search_row
  assign show_country = section.settings.show_country
  assign country_selector_style = section.settings.country_selector_style
  assign show_language = section.settings.show_language
  assign localization_font = section.settings.localization_font
  assign localization_font_size = section.settings.localization_font_size
  assign localization_position = section.settings.localization_position
  assign localization_row = section.settings.localization_row
  assign section_width = section.settings.section_width
  assign section_height = section.settings.section_height

  # Determine if header should be transparent
  assign is_transparent = false
  if enable_transparent_header_home and template == 'index'
    assign is_transparent = true
    assign header_color_scheme = header_color_scheme_transparent
  elsif enable_transparent_header_product and template contains 'product'
    assign is_transparent = true
    assign header_color_scheme = header_color_scheme_transparent
  elsif enable_transparent_header_collection and template contains 'collection'
    assign is_transparent = true
    assign header_color_scheme = header_color_scheme_transparent
  endif

  # Determine color scheme for homepage
  if template == 'index' and home_color_scheme == 'inverse'
    assign header_color_scheme = header_color_scheme_transparent
  endif

  # Determine color scheme for product pages
  if template contains 'product' and product_color_scheme == 'inverse'
    assign header_color_scheme = header_color_scheme_transparent
  endif

  # Determine color scheme for collection pages
  if template contains 'collection' and collection_color_scheme == 'inverse'
    assign header_color_scheme = header_color_scheme_transparent
  endif

  # Set sticky header class
  assign sticky_class = ''
  if enable_sticky_header == 'always'
    assign sticky_class = 'header--sticky'
  elsif enable_sticky_header == 'on_scroll_up'
    assign sticky_class = 'header--sticky-on-scroll-up'
    endif
-%}

<style>
  .header {
    transition: all 0.3s ease;
    background: rgba(0, 0, 0, 0.9);
    position: relative;
    z-index: 1000;
  }
  
  .header--scrolled {
    background: rgba(0, 0, 0, 1);
    box-shadow: 0 2px 20px rgba(0, 0, 0, 0.3);
  }
  
  .header--transparent {
    background: transparent !important;
  }
  
  .header--transparent.header--scrolled {
    background: rgba(0, 0, 0, 0.95) !important;
  }
  
  .header__nav-link {
    position: relative;
    transition: color 0.3s ease;
    color: white !important;
  }
  
  .header__nav-link::after {
    content: '';
    position: absolute;
    bottom: -5px;
    left: 0;
    width: 0;
    height: 2px;
    background: #ff0000;
    transition: width 0.3s ease;
  }
  
  .header__nav-link:hover::after {
    width: 100%;
  }
  
  .header__nav-link:hover {
    color: #ff0000 !important;
  }
  
  .dropdown-menu {
    position: absolute;
    top: 100%;
    left: 0;
    background: rgba(0, 0, 0, 0.95);
    min-width: 200px;
    opacity: 0;
    visibility: hidden;
    transform: translateY(-10px);
    transition: all 0.3s ease;
    border-radius: 8px;
    padding: 10px 0;
    z-index: 1000;
  }
  
  .header__nav-item:hover .dropdown-menu {
    opacity: 1;
    visibility: visible;
    transform: translateY(0);
  }
  
  .dropdown-menu a {
    display: block;
    padding: 10px 20px;
    color: white;
    text-decoration: none;
    transition: all 0.3s ease;
  }
  
  .dropdown-menu a:hover {
    background: rgba(255, 0, 0, 0.2);
    color: #ff0000;
  }
  
  /* Ensure hero section content is visible over transparent header */
  .hero {
    position: relative;
    z-index: 1;
  }
  
  .hero__content {
    position: relative;
    z-index: 2;
  }
  
  /* Force header transparency on homepage */
  {% if template == 'index' %}
  .header {
    background: transparent !important;
  }
  
  .header--scrolled {
    background: rgba(0, 0, 0, 0.95) !important;
  }
  {% endif %}
</style>

<header
  class="
    header
    header--{{ section_height }}
    {{ sticky_class }}
    {% if is_transparent %}header--transparent{% endif %}
    color-{{ header_color_scheme }}
  "
  data-header
  id="main-header"
>
  <div class="header__content">
    <div class="header__row header__row--{{ menu_row }}">
      {% if search_position == 'left' %}
        <div class="header__search-wrapper">
          {%- if show_search -%}
            <button class="header__search-toggle" aria-label="{{ 'accessibility.search' | t }}">
              <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                <path d="M19 19L13 13M15 8A7 7 0 1 1 1 8A7 7 0 0 1 15 8Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </button>
          {%- endif -%}
        </div>
      {% endif %}

      <div class="header__logo-wrapper">
        {%- if section.blocks['header-logo'] -%}
          {%- render 'header-logo', block: section.blocks['header-logo'] -%}
        {%- else -%}
          <a href="/" class="header__logo">
            <span class="header__logo-text" style="color: #ff0000; font-size: 2rem; font-weight: bold;">ANIQI</span>
          </a>
        {%- endif -%}
      </div>

      <nav class="header__nav" role="navigation" aria-label="{{ 'accessibility.navigation' | t }}">
        <ul class="header__nav-list">
          <li class="header__nav-item">
            <a href="/collections/all" class="header__nav-link">PRODUCTS</a>
          </li>
          <li class="header__nav-item">
            <a href="#" class="header__nav-link">ANIME</a>
            <div class="dropdown-menu">
              <a href="/collections/berserk">BERSERK</a>
              <a href="/collections/leaf-village">LEAF VILLAGE</a>
              <a href="/collections/aot">AOT</a>
              <a href="/collections/one-piece">OP</a>
              <a href="/collections/dbz">DBZ</a>
              <a href="/collections/jjk">JJK</a>
              <a href="/collections/hashira">HASHIRA</a>
              <a href="/collections/other-anime">OTHER ANIME</a>
            </div>
          </li>
          <li class="header__nav-item">
            <a href="/collections/new-releases" class="header__nav-link">NEW RELEASES</a>
          </li>
          <li class="header__nav-item">
            <a href="/pages/contact" class="header__nav-link">CONTACT</a>
          </li>
          <li class="header__nav-item">
            <a href="/pages/reviews" class="header__nav-link">REVIEWS</a>
          </li>
          <li class="header__nav-item">
            <a href="/collections/clearance" class="header__nav-link">CLEARANCE</a>
          </li>
        </ul>
      </nav>

      <div class="header__actions">
        {% if search_position == 'right' %}
          <div class="header__search-wrapper">
            {%- if show_search -%}
              <button class="header__search-toggle" aria-label="{{ 'accessibility.search' | t }}">
                <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                  <path d="M19 19L13 13M15 8A7 7 0 1 1 1 8A7 7 0 0 1 15 8Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
              </button>
            {%- endif -%}
          </div>
        {% endif %}

        <div class="header__localization">
          {%- if show_country -%}
            {%- render 'dropdown-localization', type: 'country' -%}
          {%- endif -%}
          {%- if show_language -%}
            {%- render 'dropdown-localization', type: 'language' -%}
          {%- endif -%}
        </div>

        <div class="header__cart">
          <a href="/cart" class="header__cart-link" aria-label="{{ 'accessibility.cart' | t }}">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
              <path d="M9 22C9.55228 22 10 21.5523 10 21C10 20.4477 9.55228 20 9 20C8.44772 20 8 20.4477 8 21C8 21.5523 8.44772 22 9 22Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              <path d="M20 22C20.5523 22 21 21.5523 21 21C21 20.4477 20.5523 20 20 20C19.4477 20 19 20.4477 19 21C19 21.5523 19.4477 22 20 22Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              <path d="M1 1H5L7.68 14.39C7.77144 14.8504 8.02191 15.264 8.38755 15.5583C8.75318 15.8526 9.2107 16.009 9.68 16H19.4C19.8693 16.009 20.3268 15.8526 20.6925 15.5583C21.0581 15.264 21.3086 14.8504 21.4 14.39L23 6H6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </a>
        </div>
      </div>
    </div>
  </div>
</header>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    const header = document.getElementById('main-header');
    let lastScrollTop = 0;
    
    // Force transparency on homepage
    if (window.location.pathname === '/' || window.location.pathname === '/index') {
      header.classList.add('header--transparent');
    }
    
    window.addEventListener('scroll', function() {
      const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
      
      // Add scrolled class for background change
      if (scrollTop > 50) {
        header.classList.add('header--scrolled');
      } else {
        header.classList.remove('header--scrolled');
      }
      
      // Hide/show header on scroll (optional effect)
      if (scrollTop > lastScrollTop && scrollTop > 100) {
        // Scrolling down
        header.style.transform = 'translateY(-100%)';
      } else {
        // Scrolling up
        header.style.transform = 'translateY(0)';
      }
      
      lastScrollTop = scrollTop;
    });
  });
</script>

{% stylesheet %}
  .header {
    position: relative;
    z-index: 100;
    background: var(--color-background);
    border-bottom: 1px solid var(--color-border);
  }

  .header--transparent {
    background: transparent;
    border-bottom: none;
  }

  .header--sticky {
    position: sticky;
    top: 0;
  }

  .header__content {
    padding: 1rem 0;
  }

  .header__row {
    display: flex;
    align-items: center;
    justify-content: space-between;
    max-width: var(--page-width);
    margin: 0 auto;
    padding: 0 2rem;
  }

  .header__logo-wrapper {
    flex: 1;
    display: flex;
    justify-content: center;
  }

  .header__nav {
    flex: 2;
    display: flex;
    justify-content: center;
  }

  .header__nav-list {
    display: flex;
    list-style: none;
    margin: 0;
    padding: 0;
    gap: 2rem;
  }

  .header__nav-link {
    color: var(--color-foreground);
    text-decoration: none;
    font-weight: 600;
    font-size: 0.875rem;
    letter-spacing: 0.05em;
    text-transform: uppercase;
    transition: opacity 0.2s ease;
  }

  .header__nav-link:hover {
    opacity: 0.7;
  }

  .header__actions {
    flex: 1;
    display: flex;
    justify-content: flex-end;
    align-items: center;
    gap: 1rem;
  }

  .header__search-toggle,
  .header__cart-link {
    background: none;
    border: none;
    color: var(--color-foreground);
    cursor: pointer;
    padding: 0.5rem;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .header__cart-count {
    position: absolute;
    top: -8px;
    right: -8px;
    background: var(--color-primary);
    color: var(--color-primary-text);
    border-radius: 50%;
    width: 20px;
    height: 20px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 0.75rem;
    font-weight: 600;
  }

  @media (max-width: 749px) {
    .header__nav {
      display: none;
    }
    
    .header__row {
      padding: 0 1rem;
    }
  }
{% endstylesheet %}

{% schema %}
{
  "name": "Header",
  "settings": [
    {
      "type": "header",
      "content": "Layout"
    },
    {
      "type": "select",
      "id": "section_height",
      "label": "Section height",
      "options": [
        {
          "value": "small",
          "label": "Small"
        },
        {
          "value": "standard",
          "label": "Standard"
        },
        {
          "value": "large",
          "label": "Large"
        }
      ],
      "default": "standard"
    },
    {
      "type": "select",
      "id": "section_width",
      "label": "Section width",
      "options": [
        {
          "value": "page-width",
          "label": "Page width"
        },
        {
          "value": "full-width",
          "label": "Full width"
        }
      ],
      "default": "full-width"
    },
    {
      "type": "header",
      "content": "Logo"
    },
    {
      "type": "select",
      "id": "logo_position",
      "label": "Logo position",
      "options": [
        {
          "value": "left",
          "label": "Left"
        },
        {
          "value": "center",
          "label": "Center"
        },
        {
          "value": "right",
          "label": "Right"
        }
      ],
      "default": "center"
    },
    {
      "type": "header",
      "content": "Navigation"
    },
    {
      "type": "select",
      "id": "menu_position",
      "label": "Menu position",
      "options": [
        {
          "value": "left",
          "label": "Left"
        },
        {
          "value": "center",
          "label": "Center"
        },
        {
          "value": "right",
          "label": "Right"
        }
      ],
      "default": "left"
    },
    {
      "type": "select",
      "id": "menu_row",
      "label": "Menu row",
      "options": [
        {
          "value": "top",
          "label": "Top"
        },
        {
          "value": "bottom",
          "label": "Bottom"
        }
      ],
      "default": "top"
    },
    {
      "type": "header",
      "content": "Search"
    },
    {
      "type": "checkbox",
      "id": "show_search",
      "label": "Show search",
      "default": true
    },
    {
      "type": "select",
      "id": "search_position",
      "label": "Search position",
      "options": [
        {
          "value": "left",
          "label": "Left"
        },
        {
          "value": "right",
          "label": "Right"
        }
      ],
      "default": "right"
    },
    {
      "type": "select",
      "id": "search_row",
      "label": "Search row",
      "options": [
        {
          "value": "top",
          "label": "Top"
        },
        {
          "value": "bottom",
          "label": "Bottom"
        }
      ],
      "default": "top"
    },
    {
      "type": "header",
      "content": "Localization"
    },
    {
      "type": "checkbox",
      "id": "show_country",
      "label": "Show country selector",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "country_selector_style",
      "label": "Show country selector style",
      "default": false
    },
    {
      "type": "checkbox",
      "id": "show_language",
      "label": "Show language selector",
      "default": true
    },
    {
      "type": "select",
      "id": "localization_font",
      "label": "Localization font",
      "options": [
        {
          "value": "heading",
          "label": "Heading"
        },
        {
          "value": "body",
          "label": "Body"
        }
      ],
      "default": "heading"
    },
    {
      "type": "range",
      "id": "localization_font_size",
      "label": "Localization font size",
      "min": 0.8,
      "max": 1.2,
      "step": 0.2,
      "default": 1
    },
    {
      "type": "select",
      "id": "localization_position",
      "label": "Localization position",
      "options": [
        {
          "value": "left",
          "label": "Left"
        },
        {
          "value": "right",
          "label": "Right"
        }
      ],
      "default": "right"
    },
    {
      "type": "select",
      "id": "localization_row",
      "label": "Localization row",
      "options": [
        {
          "value": "top",
          "label": "Top"
        },
        {
          "value": "bottom",
          "label": "Bottom"
        }
      ],
      "default": "top"
    },
    {
      "type": "header",
      "content": "Sticky header"
    },
    {
      "type": "select",
      "id": "enable_sticky_header",
      "label": "Enable sticky header",
      "options": [
        {
          "value": "never",
          "label": "Never"
        },
        {
          "value": "always",
          "label": "Always"
        },
        {
          "value": "on_scroll_up",
          "label": "On scroll up"
        }
      ],
      "default": "always"
    },
    {
      "type": "header",
      "content": "Transparent header"
    },
    {
      "type": "checkbox",
      "id": "enable_transparent_header_home",
      "label": "Enable transparent header on homepage",
      "default": true
    },
    {
      "type": "select",
      "id": "home_color_scheme",
      "label": "Homepage color scheme",
      "options": [
        {
          "value": "default",
          "label": "Default"
        },
        {
          "value": "inverse",
          "label": "Inverse"
        }
      ],
      "default": "inverse"
    },
    {
      "type": "checkbox",
      "id": "enable_transparent_header_product",
      "label": "Enable transparent header on product pages",
      "default": true
    },
    {
      "type": "select",
      "id": "product_color_scheme",
      "label": "Product page color scheme",
      "options": [
        {
          "value": "default",
          "label": "Default"
        },
        {
          "value": "inverse",
          "label": "Inverse"
        }
      ],
      "default": "default"
    },
    {
      "type": "checkbox",
      "id": "enable_transparent_header_collection",
      "label": "Enable transparent header on collection pages",
      "default": true
    },
    {
      "type": "select",
      "id": "collection_color_scheme",
      "label": "Collection page color scheme",
      "options": [
        {
          "value": "default",
          "label": "Default"
        },
        {
          "value": "inverse",
          "label": "Inverse"
        }
      ],
      "default": "inverse"
    },
    {
      "type": "header",
      "content": "Divider"
    },
    {
      "type": "range",
      "id": "divider_width",
      "label": "Divider width",
      "min": 0,
      "max": 10,
      "step": 1,
      "default": 0
    },
    {
      "type": "select",
      "id": "divider_size",
      "label": "Divider size",
      "options": [
        {
          "value": "page-width",
          "label": "Page width"
        },
        {
          "value": "full-width",
          "label": "Full width"
        }
      ],
      "default": "page-width"
    },
    {
      "type": "header",
      "content": "Color scheme"
    },
    {
      "type": "color_scheme",
      "id": "color_scheme",
      "label": "Color scheme",
      "default": "scheme-1"
    },
    {
      "type": "color_scheme",
      "id": "color_scheme_transparent",
      "label": "Transparent color scheme",
      "default": "scheme-6"
    }
  ],
  "blocks": [
    {
      "type": "header-logo",
      "name": "Logo",
      "limit": 1
    }
  ],
  "presets": [
    {
      "name": "Header"
    }
  ]
}
{% endschema %}
